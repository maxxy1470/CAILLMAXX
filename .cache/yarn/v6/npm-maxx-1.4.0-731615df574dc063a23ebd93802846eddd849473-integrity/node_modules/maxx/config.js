const path = require("path");
const fs = require("fs");
const dotenv = require("dotenv");
const homedir = require("os").homedir();

const envFile = path.join(homedir, ".maxx.env");

let values = {};

const exists = () => fs.existsSync(envFile);

const get = key => values[key];

const put = (key, val) => (values[key] = val);

const valuesAsString = () =>
  Object.entries(values)
    .map(([key, val]) => `${key}=${val}`)
    .join("\n");

const valuesFromFile = () => dotenv.parse(fs.readFileSync(envFile, "utf8"));

const save = () => fs.writeFileSync(envFile, valuesAsString());

const load = () => {
  values = valuesFromFile();
};

module.exports = {
  exists,
  get,
  put,
  save,
  load
};
